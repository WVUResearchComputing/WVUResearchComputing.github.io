

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Conda &mdash; WVU-RC 2023.04.03 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GPU Computing" href="43.UsingGPUs.html" />
    <link rel="prev" title="Singularity Containers" href="41.Singularity.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WVU-RC
          

          
            
            <img src="../_static/ResearchComputing.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2023.04
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10.Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="20.QuickStart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="30.BasicUsage.html">Basic Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="40.AdvancedUsage.html">Advanced Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="41.Singularity.html">Singularity Containers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Conda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anaconda-vs-minicoda">Anaconda vs Minicoda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activating-conda-on-spruce-and-thorny-flat">Activating Conda on Spruce and Thorny Flat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conda-environments">Conda Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#knowing-which-environments-are-available">Knowing which environments are available</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activating-an-existing-environment">Activating an existing environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deactivating-the-current-environment">Deactivating the current environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-new-environment">Create a new environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conda-and-python">Conda and Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managing-packages-and-channels">Managing packages and channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-new-environment-from-a-yml-file">Creating a new environment from a YML file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listing-the-packages-inside-one-environment">Listing the packages inside one environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-a-conda-environment-in-a-submission-script">Using a conda environment in a submission script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deleting-a-environment">Deleting a environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-documentation">More documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#downloading-miniconda">Downloading Miniconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#no-installing-anything">No installing anything</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="43.UsingGPUs.html">GPU Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="44.Modules.html">Environment Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="45.Jupyter.html">Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="46.HDF5.html">HDF5: Hierarchical Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="47.XWindow.html">XWindow</a></li>
<li class="toctree-l2"><a class="reference internal" href="48.Compilers.html">Compile Source Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="500.ScientificProgramming.html">Scientific Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="600.SoftAdmin.html">Software Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="70.DomainSpecific.html">Domain Specific Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="80.ClusterSpecific.html">Clusters Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="90.References.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WVU-RC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="40.AdvancedUsage.html">Advanced Usage</a> &raquo;</li>
        
      <li>Conda</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/text/42.Conda.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="conda">
<span id="ad-conda"></span><h1>Conda<a class="headerlink" href="#conda" title="Permalink to this headline">¶</a></h1>
<p>Conda is an open source package management system and environment management system.
Conda quickly installs, runs and updates packages and their dependencies.
Conda easily creates, saves, loads and switches between environments.
It was created for Python programs, but it can package and distribute software for any language.</p>
<p>Conda as a package manager helps you find and install packages.
If you need a package that requires a different version of Python, you do not need to switch to a different environment manager, because conda is also an environment manager.
With just a few commands, you can set up a totally separate environment to run that different version of Python, while continuing to run your usual version of Python in your normal environment.</p>
<p>There are two installers for conda, Anaconda and Miniconda.</p>
<section id="anaconda-vs-minicoda">
<h2>Anaconda vs Minicoda<a class="headerlink" href="#anaconda-vs-minicoda" title="Permalink to this headline">¶</a></h2>
<p>Anaconda is a downloadable, free, open source, high-performance and optimized Python and R distribution.
Anaconda includes conda, conda-build, Python, and 100+ automatically installed, open source scientific packages and their dependencies that have been tested to work well together, including SciPy, NumPy and many others.
Ananconda is more suited to be installed on a desktop environment as you get after installation a fairly complete environment for scientific computing.</p>
<p>From the other side Miniconda is free minimal installer for conda.
Miniconda is a small, bootstrap version of Anaconda that includes only conda, Python, the packages they depend on and a small number of other useful packages, including pip, zlib and a few others.
Miniconda is more suited for HPC environments where a minimal installation is all that is needed and users can create their own environments as needed.</p>
</section>
<section id="activating-conda-on-spruce-and-thorny-flat">
<h2>Activating Conda on Spruce and Thorny Flat<a class="headerlink" href="#activating-conda-on-spruce-and-thorny-flat" title="Permalink to this headline">¶</a></h2>
<p>On Spruce you can activate conda with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">conda</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>On Thorny Flat the command to activate conda is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">conda_init</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>After activation your are positioned on the <code class="docutils literal notranslate"><span class="pre">base</span></code> environment.</p>
</section>
<section id="conda-environments">
<h2>Conda Environments<a class="headerlink" href="#conda-environments" title="Permalink to this headline">¶</a></h2>
<p>Conda allows you to create separate environments containing files, packages and their dependencies that will not interact with other environments.</p>
<p>When you begin using conda, you already have a default environment named <code class="docutils literal notranslate"><span class="pre">base</span></code>.
You cannot install packages on the <code class="docutils literal notranslate"><span class="pre">base</span></code> environment.
Yous should create new environments for installing packages.
Try to keep separate environments for different packages or group of packages.
That reduces the chances of incompatibility between them</p>
</section>
<section id="knowing-which-environments-are-available">
<h2>Knowing which environments are available<a class="headerlink" href="#knowing-which-environments-are-available" title="Permalink to this headline">¶</a></h2>
<p>By the time of writing this tutorial Spruce offers three environments
centrally installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; conda info --envs

# conda environments:
#
                         /scratch/gufranco/conda-intel
base                     /shared/software/miniconda3
genomics-core            /shared/software/miniconda3/envs/genomics-core
jupyter                  /shared/software/miniconda3/envs/jupyter
python27                 /shared/software/miniconda3/envs/python27
python35                 /shared/software/miniconda3/envs/python35
python36                 /shared/software/miniconda3/envs/python36
python37                 /shared/software/miniconda3/envs/python37
qiime2-2018.8            /shared/software/miniconda3/envs/qiime2-2018.8
snowflakes               /shared/software/miniconda3/envs/snowflakes
tpd0001                  /shared/software/miniconda3/envs/tpd0001
</pre></div>
</div>
</section>
<section id="activating-an-existing-environment">
<h2>Activating an existing environment<a class="headerlink" href="#activating-an-existing-environment" title="Permalink to this headline">¶</a></h2>
<p>Suppose that you want to use the environment called “tpd0001”, to
achieve that execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">tpd0001</span>
</pre></div>
</div>
</section>
<section id="deactivating-the-current-environment">
<h2>Deactivating the current environment<a class="headerlink" href="#deactivating-the-current-environment" title="Permalink to this headline">¶</a></h2>
<p>The current environment can be deactivated with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">deactivate</span>
</pre></div>
</div>
<p>If you are in the <code class="docutils literal notranslate"><span class="pre">base</span></code> environment, the deactivation will not have any effect.
You are always at least on the <code class="docutils literal notranslate"><span class="pre">base</span></code> environment.</p>
</section>
<section id="create-a-new-environment">
<h2>Create a new environment<a class="headerlink" href="#create-a-new-environment" title="Permalink to this headline">¶</a></h2>
<p>We will name the environment snowflakes and install the package BioPython.
At the Anaconda Prompt or in your terminal window, type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">snowflakes</span>
</pre></div>
</div>
<p>or if you want also to install a package you can execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">snowflakes</span> <span class="n">biopython</span>
</pre></div>
</div>
<p>Conda collects metadata about the package and its dependencies and produces an installation plan:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Package Plan ##</span>

<span class="n">environment</span> <span class="n">location</span><span class="p">:</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">snowflakes</span>

<span class="n">added</span> <span class="o">/</span> <span class="n">updated</span> <span class="n">specs</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">biopython</span>


<span class="n">The</span> <span class="n">following</span> <span class="n">packages</span> <span class="n">will</span> <span class="n">be</span> <span class="n">downloaded</span><span class="p">:</span>

    <span class="n">package</span>                    <span class="o">|</span>            <span class="n">build</span>
    <span class="o">---------------------------|-----------------</span>
    <span class="n">_libgcc_mutex</span><span class="o">-</span><span class="mf">0.1</span>          <span class="o">|</span>             <span class="n">main</span>           <span class="mi">3</span> <span class="n">KB</span>
    <span class="n">biopython</span><span class="o">-</span><span class="mf">1.74</span>             <span class="o">|</span>   <span class="n">py37h7b6447c_0</span>         <span class="mf">2.0</span> <span class="n">MB</span>
    <span class="n">blas</span><span class="o">-</span><span class="mf">1.0</span>                   <span class="o">|</span>              <span class="n">mkl</span>           <span class="mi">6</span> <span class="n">KB</span>
    <span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="o">-</span><span class="mf">2019.8.28</span>  <span class="o">|</span>                <span class="mi">0</span>         <span class="mi">132</span> <span class="n">KB</span>
    <span class="n">certifi</span><span class="o">-</span><span class="mf">2019.9.11</span>          <span class="o">|</span>           <span class="n">py37_0</span>         <span class="mi">154</span> <span class="n">KB</span>
    <span class="n">intel</span><span class="o">-</span><span class="n">openmp</span><span class="o">-</span><span class="mf">2019.4</span>        <span class="o">|</span>              <span class="mi">243</span>         <span class="mi">729</span> <span class="n">KB</span>
    <span class="n">libedit</span><span class="o">-</span><span class="mf">3.1.20181209</span>       <span class="o">|</span>       <span class="n">hc058e9b_0</span>         <span class="mi">163</span> <span class="n">KB</span>
    <span class="n">libffi</span><span class="o">-</span><span class="mf">3.2.1</span>               <span class="o">|</span>       <span class="n">hd88cf55_4</span>          <span class="mi">40</span> <span class="n">KB</span>
    <span class="n">libgcc</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mf">9.1.0</span>            <span class="o">|</span>       <span class="n">hdf63c60_0</span>         <span class="mf">5.1</span> <span class="n">MB</span>
    <span class="n">libgfortran</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mf">7.3.0</span>       <span class="o">|</span>       <span class="n">hdf63c60_0</span>        <span class="mi">1006</span> <span class="n">KB</span>
    <span class="n">libstdcxx</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="mf">9.1.0</span>         <span class="o">|</span>       <span class="n">hdf63c60_0</span>         <span class="mf">3.1</span> <span class="n">MB</span>
    <span class="n">mkl</span><span class="o">-</span><span class="mf">2019.4</span>                 <span class="o">|</span>              <span class="mi">243</span>       <span class="mf">131.2</span> <span class="n">MB</span>
    <span class="n">mkl</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="mf">2.3.0</span>          <span class="o">|</span>   <span class="n">py37he904b0f_0</span>         <span class="mi">218</span> <span class="n">KB</span>
    <span class="n">mkl_fft</span><span class="o">-</span><span class="mf">1.0.14</span>             <span class="o">|</span>   <span class="n">py37ha843d7b_0</span>         <span class="mi">155</span> <span class="n">KB</span>
    <span class="n">mkl_random</span><span class="o">-</span><span class="mf">1.1.0</span>           <span class="o">|</span>   <span class="n">py37hd6b4f25_0</span>         <span class="mi">321</span> <span class="n">KB</span>
    <span class="n">ncurses</span><span class="o">-</span><span class="mf">6.1</span>                <span class="o">|</span>       <span class="n">he6710b0_1</span>         <span class="mi">777</span> <span class="n">KB</span>
    <span class="n">numpy</span><span class="o">-</span><span class="mf">1.17.2</span>               <span class="o">|</span>   <span class="n">py37haad9e8e_0</span>           <span class="mi">4</span> <span class="n">KB</span>
    <span class="n">numpy</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">1.17.2</span>          <span class="o">|</span>   <span class="n">py37hde5b4d6_0</span>         <span class="mf">4.2</span> <span class="n">MB</span>
    <span class="n">openssl</span><span class="o">-</span><span class="mf">1.1.1</span><span class="n">d</span>             <span class="o">|</span>       <span class="n">h7b6447c_1</span>         <span class="mf">3.7</span> <span class="n">MB</span>
    <span class="n">pip</span><span class="o">-</span><span class="mf">19.2.3</span>                 <span class="o">|</span>           <span class="n">py37_0</span>         <span class="mf">1.9</span> <span class="n">MB</span>
    <span class="n">python</span><span class="o">-</span><span class="mf">3.7.4</span>               <span class="o">|</span>       <span class="n">h265db76_1</span>        <span class="mf">32.1</span> <span class="n">MB</span>
    <span class="n">readline</span><span class="o">-</span><span class="mf">7.0</span>               <span class="o">|</span>       <span class="n">h7b6447c_5</span>         <span class="mi">324</span> <span class="n">KB</span>
    <span class="n">setuptools</span><span class="o">-</span><span class="mf">41.2.0</span>          <span class="o">|</span>           <span class="n">py37_0</span>         <span class="mi">630</span> <span class="n">KB</span>
    <span class="n">six</span><span class="o">-</span><span class="mf">1.12.0</span>                 <span class="o">|</span>           <span class="n">py37_0</span>          <span class="mi">23</span> <span class="n">KB</span>
    <span class="n">sqlite</span><span class="o">-</span><span class="mf">3.29.0</span>              <span class="o">|</span>       <span class="n">h7b6447c_0</span>         <span class="mf">1.1</span> <span class="n">MB</span>
    <span class="n">tk</span><span class="o">-</span><span class="mf">8.6.8</span>                   <span class="o">|</span>       <span class="n">hbc83047_0</span>         <span class="mf">2.8</span> <span class="n">MB</span>
    <span class="n">wheel</span><span class="o">-</span><span class="mf">0.33.6</span>               <span class="o">|</span>           <span class="n">py37_0</span>          <span class="mi">40</span> <span class="n">KB</span>
    <span class="n">xz</span><span class="o">-</span><span class="mf">5.2.4</span>                   <span class="o">|</span>       <span class="n">h14c3975_4</span>         <span class="mi">283</span> <span class="n">KB</span>
    <span class="n">zlib</span><span class="o">-</span><span class="mf">1.2.11</span>                <span class="o">|</span>       <span class="n">h7b6447c_3</span>         <span class="mi">103</span> <span class="n">KB</span>
    <span class="o">------------------------------------------------------------</span>
                                           <span class="n">Total</span><span class="p">:</span>       <span class="mf">192.2</span> <span class="n">MB</span>
</pre></div>
</div>
<p>Conda asks if you want to proceed with the plan:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Proceed ([y]/n)? y
Type &quot;y&quot; and press Enter to proceed.
</pre></div>
</div>
<p>After that, conda, download and installs the packages creating a new environment for you.
The final message shows how to activate and deactivate the environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Preparing</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">done</span>
<span class="n">Verifying</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">done</span>
<span class="n">Executing</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">done</span>
<span class="c1">#</span>
<span class="c1"># To activate this environment, use</span>
<span class="c1">#</span>
<span class="c1">#     $ conda activate snowflakes</span>
<span class="c1">#</span>
<span class="c1"># To deactivate an active environment, use</span>
<span class="c1">#</span>
<span class="c1">#     $ conda deactivate</span>
</pre></div>
</div>
<p>Each environment is isolated from other conda environments and that allow you to keep several environments with different packages on them or different versions of the same packages.
As the message shows you activate the environment with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">snowflakes</span>
</pre></div>
</div>
<p>Notice that when you activate a new environment, the prompt changes adding a prefix in parenthesis to indicate on which conda environment are you using at that moment.
To check the environments available execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="nb">list</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">info</span> <span class="o">--</span><span class="n">envs</span>
</pre></div>
</div>
</section>
<section id="conda-and-python">
<h2>Conda and Python<a class="headerlink" href="#conda-and-python" title="Permalink to this headline">¶</a></h2>
<p>When you create a new environment, conda installs the same Python version used to install conda on Spruce and Thorny (3.7).
If you want to use a different version of Python, for example Python 2.7, simply create a new environment and specify the version of Python that you want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">python27</span> <span class="n">python</span><span class="o">=</span><span class="mf">2.7</span>
</pre></div>
</div>
<p>You activate the environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">python27</span>
</pre></div>
</div>
<p>And verify the python version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python --version
Python 2.7.16 :: Anaconda, Inc.
</pre></div>
</div>
<p>Conda has packages for versions of python for 2.7, 3.5, 3.6 and 3.7</p>
</section>
<section id="managing-packages-and-channels">
<h2>Managing packages and channels<a class="headerlink" href="#managing-packages-and-channels" title="Permalink to this headline">¶</a></h2>
<p>New packages can be installed to existing conda environments. First search for packages with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">search</span> <span class="n">mkl</span>
</pre></div>
</div>
<p>Packages are stored in repositories called <strong>channels</strong>.
By default, conda search on the <code class="docutils literal notranslate"><span class="pre">pkgs/main</span></code> channel only.
However, there are many other packages on several other channels.</p>
<p>The most prominent channels to search for packages are <strong>intel</strong>, <strong>conda-forge</strong> and <strong>bioconda</strong>
To search for packages there execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">search</span> <span class="o">-</span><span class="n">c</span> <span class="n">intel</span> <span class="n">mkl</span>

<span class="n">conda</span> <span class="n">search</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">nitime</span>

<span class="n">conda</span> <span class="n">search</span> <span class="o">-</span><span class="n">c</span> <span class="n">bioconda</span> <span class="n">blast</span>
</pre></div>
</div>
<p>Packages can be installed on the current environment with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">nitime</span>
</pre></div>
</div>
<p>In this case conda will pick the most recent version of the package compatible with the packages already present on the current environment.
You can also be very selective on version and build that you want for the package.
First get the list of versions and builds for the package that you want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda search -c intel mkl
Loading channels: done
# Name                       Version           Build  Channel
mkl                         2017.0.3         intel_6  intel
mkl                         2017.0.4      h4c4d0af_0  pkgs/main
mkl                         2018.0.0      hb491cac_4  pkgs/main
mkl                         2018.0.0         intel_4  intel
mkl                         2018.0.1      h19d6760_4  pkgs/main
mkl                         2018.0.1         intel_4  intel
mkl                         2018.0.2               1  pkgs/main
mkl                         2018.0.2         intel_1  intel
mkl                         2018.0.3               1  pkgs/main
mkl                         2018.0.3         intel_1  intel
mkl                           2019.0             117  pkgs/main
mkl                           2019.0             118  pkgs/main
mkl                           2019.0       intel_117  intel
mkl                           2019.1             144  pkgs/main
mkl                           2019.1       intel_144  intel
mkl                           2019.2       intel_187  intel
mkl                           2019.3             199  pkgs/main
mkl                           2019.3       intel_199  intel
mkl                           2019.4             243  pkgs/main
mkl                           2019.4       intel_243  intel
mkl                           2019.5       intel_281  intel
</pre></div>
</div>
<p>Now, install the package declaring the version and build:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install -c intel mkl=2019.4=intel_243
Collecting package metadata (current_repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: /users/gufranco/.conda/envs/test

  added / updated specs:
    - mkl==2019.4=intel_243


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    intel-openmp-2019.5        |        intel_281         888 KB  intel
    mkl-2019.4                 |        intel_243       204.1 MB  intel
    tbb-2019.8                 |        intel_281         874 KB  intel
    ------------------------------------------------------------
                                           Total:       205.8 MB

The following NEW packages will be INSTALLED:

  intel-openmp       intel/linux-64::intel-openmp-2019.5-intel_281
  mkl                intel/linux-64::mkl-2019.4-intel_243
  tbb                intel/linux-64::tbb-2019.8-intel_281


Proceed ([y]/n)?


Downloading and Extracting Packages
tbb-2019.8           | 874 KB    | #################################################################################################################################### | 100%
mkl-2019.4           | 204.1 MB  | #################################################################################################################################### | 100%
intel-openmp-2019.5  | 888 KB    | #################################################################################################################################### | 100%
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
</pre></div>
</div>
</section>
<section id="creating-a-new-environment-from-a-yml-file">
<h2>Creating a new environment from a YML file<a class="headerlink" href="#creating-a-new-environment-from-a-yml-file" title="Permalink to this headline">¶</a></h2>
<p>You can create your own environment, one easy way of doing that is via a
YML file that describes the channels and packages that you want on your
environment. The YML file will look like this, for a simple case when
you want one env for bowtie2 (bowtie2.yml)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">spruce</span><span class="o">-</span><span class="n">bowtie2</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bioconda</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
  <span class="o">-</span> <span class="n">defaults</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bowtie2</span>
</pre></div>
</div>
<p>Another example is this YML file for installing a curated set of basic
genomics codes that requires just a few dependencies. (biocore.yml)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">biocode</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bioconda</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
  <span class="o">-</span> <span class="n">defaults</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">bamtools</span>
  <span class="o">-</span> <span class="n">bcftools</span>
  <span class="o">-</span> <span class="n">bedtools</span>
  <span class="o">-</span> <span class="n">hmmer</span>
  <span class="o">-</span> <span class="n">muscle</span>
  <span class="o">-</span> <span class="n">raxml</span>
  <span class="o">-</span> <span class="n">samtools</span>
  <span class="o">-</span> <span class="n">sga</span>
  <span class="o">-</span> <span class="n">soapdenovo</span><span class="o">-</span><span class="n">trans</span>
  <span class="o">-</span> <span class="n">soapdenovo2</span>
  <span class="o">-</span> <span class="n">sra</span><span class="o">-</span><span class="n">tools</span>
  <span class="o">-</span> <span class="n">vcftools</span>
  <span class="o">-</span> <span class="n">velvet</span>
</pre></div>
</div>
<p>To create an environment from those YML files you can select one
location on your scratch folder</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>conda env create -p $SCRATCH/bowtie2 -f bowtie2.yml
</pre></div>
</div>
<p>or for the biocore.yml</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>conda env create -p $SCRATCH/biocore -f biocore.yml
</pre></div>
</div>
<p>By default, new environments are created inside your $HOME folder on
$HOME/.conda</p>
</section>
<section id="listing-the-packages-inside-one-environment">
<h2>Listing the packages inside one environment<a class="headerlink" href="#listing-the-packages-inside-one-environment" title="Permalink to this headline">¶</a></h2>
<p>Bowtie2 has a number of dependencies (19 dependencies for 1 package)
Notice that only bowtie2 comes from bioconda channel. All other packages
are part of conda-forge, a lower level channel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate $SCRATCH/bowtie2
$ conda list
# packages in environment at /scratch/gufranco/bowtie2:
#
# Name                    Version                   Build  Channel
bowtie2                   2.3.4.2          py36h2d50403_0    bioconda
bzip2                     1.0.6                h470a237_2    conda-forge
ca-certificates           2018.8.24            ha4d7672_0    conda-forge
certifi                   2018.8.24                py36_1    conda-forge
libffi                    3.2.1                hfc679d8_5    conda-forge
libgcc-ng                 7.2.0                hdf63c60_3    conda-forge
libstdcxx-ng              7.2.0                hdf63c60_3    conda-forge
ncurses                   6.1                  hfc679d8_1    conda-forge
openssl                   1.0.2p               h470a237_0    conda-forge
perl                      5.26.2               h470a237_0    conda-forge
pip                       18.0                     py36_1    conda-forge
python                    3.6.6                h5001a0f_0    conda-forge
readline                  7.0                  haf1bffa_1    conda-forge
setuptools                40.2.0                   py36_0    conda-forge
sqlite                    3.24.0               h2f33b56_1    conda-forge
tk                        8.6.8                         0    conda-forge
wheel                     0.31.1                   py36_1    conda-forge
xz                        5.2.4                h470a237_1    conda-forge
zlib                      1.2.11               h470a237_3    conda-forge
</pre></div>
</div>
</section>
<section id="using-a-conda-environment-in-a-submission-script">
<h2>Using a conda environment in a submission script<a class="headerlink" href="#using-a-conda-environment-in-a-submission-script" title="Permalink to this headline">¶</a></h2>
<p>To execute software in a non-interactive job you need to source the main
script, activate the environment that contains the software you need,
execute the the scientific code and deactivate the environment. This is
a simple example showing that for bowtie2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash

#PBS -N MY_JOB
#PBS -q standby
#PBS -j oe
#PBS -l nodes=1:ppn=2

source /shared/software/miniconda3/etc/profile.d/conda.sh
conda activate $SCRATCH/bowtie2

bowtie2 .....

conda deactivate
</pre></div>
</div>
</section>
<section id="deleting-a-environment">
<h2>Deleting a environment<a class="headerlink" href="#deleting-a-environment" title="Permalink to this headline">¶</a></h2>
<p>To remove an environment you can just execute this command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>conda remove --all -p $SCRATCH/bowtie2
</pre></div>
</div>
</section>
<section id="more-documentation">
<h2>More documentation<a class="headerlink" href="#more-documentation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://conda.io/docs/index.html">Conda Documentation</a></p>
<p>[<a class="reference external" href="https://conda.io/docs/user-guide/tasks/manage-environments.html">https://conda.io/docs/user-guide/tasks/manage-environments.html</a>#
Managing environments]</p>
<p><a class="reference external" href="https://bioconda.github.io/">Using Bioconda — Bioconda
documentation</a></p>
<p><a class="reference external" href="https://bioconda.github.io/conda-recipe_index.html">Available packages — Bioconda
documentation</a></p>
</section>
<section id="downloading-miniconda">
<h2>Downloading Miniconda<a class="headerlink" href="#downloading-miniconda" title="Permalink to this headline">¶</a></h2>
<p>Miniconda can be downloaded from:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">repo</span><span class="o">.</span><span class="n">continuum</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">sh</span> <span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</section>
<section id="no-installing-anything">
<h2>No installing anything<a class="headerlink" href="#no-installing-anything" title="Permalink to this headline">¶</a></h2>
<p>Just load the module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">purge</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">genomics</span><span class="o">/</span><span class="n">qiime</span>
</pre></div>
</div>
<p>This module will load python 2.7.3 and qiime on top of that</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="43.UsingGPUs.html" class="btn btn-neutral float-right" title="GPU Computing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="41.Singularity.html" class="btn btn-neutral float-left" title="Singularity Containers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, West Virginia University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>