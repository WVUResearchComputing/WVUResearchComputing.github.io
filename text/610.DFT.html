

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Density Functional Theory &mdash; WVU-RC 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Big Data" href="611.BigData.html" />
    <link rel="prev" title="CHARM++ and NAMD" href="609.CHARM++_NAMD.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WVU-RC
          

          
            
            <img src="../_static/ResearchComputing.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10.Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="20.QuickStart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="30.BasicUser.html">For Basic Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="40.AdvancedUser.html">For Advanced Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="50.ProgrammingLanguages.html">Programming Languages</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="600.SoftAdmin.html">Software Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="601.SphinxDocs.html">Editing these documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="602.UserInstallation.html">Installing Packages in User Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="603.LinearAlgebra.html">Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="604.Boost.html">Boost 1.77</a></li>
<li class="toctree-l2"><a class="reference internal" href="605.MPI.html">Message Passing Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="606.HDF5_NetCDF.html">HDF5 and NetCDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="607.FFT.html">Fast Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="608.ForceFields.html">Force Field Molecular Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="609.CHARM++_NAMD.html">CHARM++ and NAMD</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Density Functional Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abinit">ABINIT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#abinit-9-4-2-on-spruce-using-intel-2019">ABINIT 9.4.2 on Spruce using Intel 2019</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parallel-version-with-gcc-9-3-and-mpich-3-4-1">Parallel version with GCC 9.3 and MPICH 3.4.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cuda-version-with-gcc-9-3-mpich-3-4-1-and-cuda-11-1">CUDA Version with GCC 9.3, MPICH 3.4.1 and CUDA 11.1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#octopus">Octopus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#octopus-11-0-on-spruce-using-intel-2019">Octopus 11.0 on Spruce using Intel 2019</a></li>
<li class="toctree-l4"><a class="reference internal" href="#octopus-10-4-with-gcc-9-3">Octopus 10.4 with GCC 9.3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quantum-espresso">Quantum Espresso</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quantum-espresso-6-8-on-spruce-using-intel-2019">Quantum Espresso 6.8 on Spruce using Intel 2019</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#siesta">Siesta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#castep">CASTEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vasp">VASP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vasp-6-2-1-on-spruce-using-intel-2019">VASP 6.2.1 on Spruce using Intel 2019</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="611.BigData.html">Big Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="612.Python.html">Python 3.9.7</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="70.DomainSpecific.html">Domain Specific Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="80.ClusterSpecific.html">Clusters Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="90.References.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WVU-RC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="600.SoftAdmin.html">Software Administration</a> &raquo;</li>
        
      <li>Density Functional Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/text/610.DFT.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="density-functional-theory">
<h1>Density Functional Theory<a class="headerlink" href="#density-functional-theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="abinit">
<h2>ABINIT<a class="headerlink" href="#abinit" title="Permalink to this headline">¶</a></h2>
<div class="section" id="abinit-9-4-2-on-spruce-using-intel-2019">
<h3>ABINIT 9.4.2 on Spruce using Intel 2019<a class="headerlink" href="#abinit-9-4-2-on-spruce-using-intel-2019" title="Permalink to this headline">¶</a></h3>
<p>This is the canonical configuration for Spruce module <code class="docutils literal notranslate"><span class="pre">dft_intel19</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">dft_intel19</span>
</pre></div>
</div>
<p>The list of modules loaded are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; module list
Currently Loaded Modulefiles:
  1) lang/gcc/9.3.0                    6) libs/fftw/3.3.8_intel19          11) atomistic/elk/7.2.42_intel19
  2) lang/intel/2019                   7) atomistic/abinit/9.4.2_intel19   12) atomistic/siesta/4.0.2_intel19
  3) lang/python/cpython_3.9.6_gcc93   8) atomistic/vasp/6.2.1_intel19     13) dft_intel19
  4) libs/libxc/5.1.5_intel19          9) atomistic/octopus/11.0_intel19
  5) libs/hdf5/1.12.1_intel19         10) atomistic/espresso/6.8_intel19
</pre></div>
</div>
<p>The building folder is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">gpfs</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">abinit</span><span class="o">-</span><span class="mf">9.4</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">build_intel19</span>
</pre></div>
</div>
<p>Create a ac9 file for autoconfigure. The file must have the same name as the
headnode with extension <code class="docutils literal notranslate"><span class="pre">.ac9</span></code> (For Spruce it will be <code class="docutils literal notranslate"><span class="pre">srih0001.ac9</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat srih0001.ac9
prefix=&quot;/shared/software/atomistic/abinit/9.4.2_intel19_impi19&quot;

with_debug_flavor=&quot;verbose&quot;
with_optim_flavor=&quot;standard&quot;

FCFLAGS_EXTRA=&quot;-heap-arrays 1 -axAVX,CORE-AVX2,CORE-AVX-I&quot;
FC_LIBS=&quot;-lstdc++ -ldl&quot;
CPP=&quot;icc -E&quot;

CC=mpiicc
CXX=mpiicpc
FC=mpiifort
enable_mpi_io=&quot;no&quot;

#with_libxc=/gpfs/shared/src/abinit-9.4.2/build_intel19/fallbacks/install_fb/intel/19.0/libxc/4.3.4
#with_hdf5=/gpfs/shared/src/abinit-9.4.2/build_intel19/fallbacks/install_fb/intel/19.0/hdf5/1.10.6
#with_netcdf=/gpfs/shared/src/abinit-9.4.2/build_intel19/fallbacks/install_fb/intel/19.0/netcdf4/4.6.3
#with_netcdf_fortran=/gpfs/shared/src/abinit-9.4.2/build_intel19/fallbacks/install_fb/intel/19.0/netcdf4_fortran/4.5.2
#with_xmlf90=/gpfs/shared/src/abinit-9.4.2/build_intel19/fallbacks/install_fb/intel/19.0/xmlf90/1.5.3.1
#with_libpsml=/gpfs/shared/src/abinit-9.4.2/build_intel19/fallbacks/install_fb/intel/19.0/libpsml/1.1.7
</pre></div>
</div>
<p>The last 6 lines are commented as they will be used after compiling the fallbacks.
Run a first configure with this ac9:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">configure</span>
</pre></div>
</div>
<p>This first configure will prepare the folders for building the fallbacks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; cd fallbacks
$&gt; CC=mpiicc CXX=mpiicpc FC=mpiifort ./build-abinit-fallbacks.sh
</pre></div>
</div>
<p>After compiling the fallbacks, move one folder up and remove the comments to the last six lines of the ac9 file enabling the fallbacks for the next configure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; cd ..
$&gt; tail -n 8 srih0001.ac9

with_libxc=/gpfs/shared/src/abinit-9.4.2/buiild_intel19/fallbacks/install_fb/intel/19.0/libxc/4.3.4
with_hdf5=/gpfs/shared/src/abinit-9.4.2/buiild_intel19/fallbacks/install_fb/intel/19.0/hdf5/1.10.6
with_netcdf=/gpfs/shared/src/abinit-9.4.2/buiild_intel19/fallbacks/install_fb/intel/19.0/netcdf4/4.6.3
with_netcdf_fortran=/gpfs/shared/src/abinit-9.4.2/buiild_intel19/fallbacks/install_fb/intel/19.0/netcdf4_fortran/4.5.2
with_xmlf90=/gpfs/shared/src/abinit-9.4.2/buiild_intel19/fallbacks/install_fb/intel/19.0/xmlf90/1.5.3.1
with_libpsml=/gpfs/shared/src/abinit-9.4.2/buiild_intel19/fallbacks/install_fb/intel/19.0/libpsml/1.1.7
</pre></div>
</div>
<p>Now proceed to configure again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; CC=mpiicc CXX=mpiicpc FC=mpiifort ../configure
</pre></div>
</div>
<p>Execute make with a appropiated number of compilation threads:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; make -j16
$&gt; make install
</pre></div>
</div>
<p>To run the testsuite go to the tests folder and execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; cd tests
$&gt; python3 ../../tests/runtests.py -j4 -n4
</pre></div>
</div>
<p>On Spruce the results of the testsuite are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Suite</span>            <span class="n">failed</span>  <span class="n">passed</span>  <span class="n">succeeded</span>  <span class="n">skipped</span>  <span class="n">disabled</span>  <span class="n">run_etime</span>  <span class="n">tot_etime</span>
<span class="n">atompaw</span>               <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">2</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">bigdft</span>                <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>       <span class="mi">19</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.03</span>
<span class="n">bigdft_paral</span>          <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">4</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.01</span>
<span class="n">built</span><span class="o">-</span><span class="ow">in</span>              <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">5</span>        <span class="mi">2</span>         <span class="mi">0</span>      <span class="mf">24.60</span>      <span class="mf">24.61</span>
<span class="n">etsf_io</span>               <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">8</span>        <span class="mi">0</span>         <span class="mi">0</span>      <span class="mf">24.32</span>      <span class="mf">24.91</span>
<span class="n">fast</span>                  <span class="mi">0</span>       <span class="mi">0</span>         <span class="mi">11</span>        <span class="mi">0</span>         <span class="mi">0</span>      <span class="mf">45.27</span>      <span class="mf">46.23</span>
<span class="n">gpu</span>                   <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">7</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.01</span>
<span class="n">libxc</span>                 <span class="mi">0</span>       <span class="mi">9</span>         <span class="mi">26</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">417.28</span>     <span class="mf">419.47</span>
<span class="n">mpiio</span>                 <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>       <span class="mi">17</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.02</span>
<span class="n">paral</span>                <span class="mi">11</span>       <span class="mi">8</span>         <span class="mi">26</span>       <span class="mi">76</span>         <span class="mi">0</span>     <span class="mf">399.02</span>     <span class="mf">402.03</span>
<span class="n">psml</span>                  <span class="mi">0</span>       <span class="mi">2</span>         <span class="mi">12</span>        <span class="mi">0</span>         <span class="mi">0</span>      <span class="mf">79.79</span>      <span class="mf">80.39</span>
<span class="n">seq</span>                   <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>       <span class="mi">18</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.02</span>
<span class="n">tutomultibinit</span>        <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">3</span>        <span class="mi">3</span>         <span class="mi">0</span>      <span class="mf">29.94</span>      <span class="mf">31.10</span>
<span class="n">tutoparal</span>             <span class="mi">0</span>       <span class="mi">1</span>          <span class="mi">0</span>       <span class="mi">27</span>         <span class="mi">0</span>      <span class="mf">33.91</span>      <span class="mf">34.53</span>
<span class="n">tutoplugs</span>             <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">4</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">tutorespfn</span>            <span class="mi">1</span>       <span class="mi">9</span>         <span class="mi">19</span>        <span class="mi">2</span>         <span class="mi">0</span>     <span class="mf">987.28</span>     <span class="mf">991.43</span>
<span class="n">tutorial</span>              <span class="mi">4</span>       <span class="mi">7</span>         <span class="mi">48</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">573.78</span>     <span class="mf">576.74</span>
<span class="n">unitary</span>               <span class="mi">0</span>       <span class="mi">0</span>         <span class="mi">18</span>       <span class="mi">20</span>         <span class="mi">0</span>      <span class="mf">97.45</span>      <span class="mf">97.74</span>
<span class="n">v1</span>                    <span class="mi">0</span>       <span class="mi">0</span>         <span class="mi">74</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">254.83</span>     <span class="mf">257.99</span>
<span class="n">v2</span>                    <span class="mi">0</span>      <span class="mi">12</span>         <span class="mi">67</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">280.23</span>     <span class="mf">283.74</span>
<span class="n">v3</span>                    <span class="mi">0</span>      <span class="mi">12</span>         <span class="mi">66</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">414.27</span>     <span class="mf">420.35</span>
<span class="n">v4</span>                    <span class="mi">0</span>      <span class="mi">10</span>         <span class="mi">51</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">302.68</span>     <span class="mf">306.88</span>
<span class="n">v5</span>                    <span class="mi">2</span>      <span class="mi">14</span>         <span class="mi">57</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">857.25</span>     <span class="mf">864.74</span>
<span class="n">v6</span>                    <span class="mi">0</span>       <span class="mi">8</span>         <span class="mi">53</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">528.13</span>     <span class="mf">533.83</span>
<span class="n">v67mbpt</span>               <span class="mi">0</span>       <span class="mi">9</span>         <span class="mi">16</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">251.67</span>     <span class="mf">254.97</span>
<span class="n">v7</span>                    <span class="mi">1</span>      <span class="mi">15</span>         <span class="mi">49</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">929.57</span>     <span class="mf">936.62</span>
<span class="n">v8</span>                    <span class="mi">0</span>      <span class="mi">17</span>         <span class="mi">50</span>        <span class="mi">4</span>         <span class="mi">0</span>    <span class="mf">1193.84</span>    <span class="mf">1199.95</span>
<span class="n">v9</span>                    <span class="mi">0</span>      <span class="mi">15</span>         <span class="mi">34</span>        <span class="mi">2</span>         <span class="mi">0</span>     <span class="mf">952.27</span>     <span class="mf">956.56</span>
<span class="n">vdwxc</span>                 <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">1</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">wannier90</span>             <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">8</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.01</span>

<span class="n">Completed</span> <span class="ow">in</span> <span class="mf">2381.46</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span> <span class="n">Average</span> <span class="n">time</span> <span class="k">for</span> <span class="n">test</span><span class="o">=</span><span class="mf">10.09</span> <span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">stdev</span><span class="o">=</span><span class="mf">22.42</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
<span class="n">Summary</span><span class="p">:</span> <span class="n">failed</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">succeeded</span><span class="o">=</span><span class="mi">693</span><span class="p">,</span> <span class="n">passed</span><span class="o">=</span><span class="mi">148</span><span class="p">,</span> <span class="n">skipped</span><span class="o">=</span><span class="mi">216</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="mi">0</span>

<span class="n">Execution</span> <span class="n">completed</span><span class="o">.</span>
<span class="n">Results</span> <span class="ow">in</span> <span class="n">HTML</span> <span class="nb">format</span> <span class="n">are</span> <span class="n">available</span> <span class="ow">in</span> <span class="n">Test_suite</span><span class="o">/</span><span class="n">suite_report</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</div>
<div class="section" id="parallel-version-with-gcc-9-3-and-mpich-3-4-1">
<h3>Parallel version with GCC 9.3 and MPICH 3.4.1<a class="headerlink" href="#parallel-version-with-gcc-9-3-and-mpich-3-4-1" title="Permalink to this headline">¶</a></h3>
<p>Abinit 9.4.1 was compiled with the following modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="mf">9.3</span><span class="o">.</span><span class="mi">0</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cpython_3</span><span class="o">.</span><span class="mf">9.4</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">parallel</span><span class="o">/</span><span class="n">mpich</span><span class="o">/</span><span class="mf">3.4</span><span class="o">.</span><span class="mi">1</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">openblas</span><span class="o">/</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">10</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">libxc</span><span class="o">/</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">xmlf90</span><span class="o">/</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">libpsml</span><span class="o">/</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">7</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">openblas</span><span class="o">/</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">10</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">hdf5</span><span class="o">/</span><span class="mf">1.12</span><span class="o">.</span><span class="mi">0</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">/</span><span class="mf">4.7</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">/</span><span class="n">fortran</span><span class="o">-</span><span class="mf">4.5</span><span class="o">.</span><span class="mi">3</span><span class="n">_gcc93</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">libs</span><span class="o">/</span><span class="n">fftw</span><span class="o">/</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">9</span><span class="n">_gcc93</span>
</pre></div>
</div>
<p>ABINIT uses a configure file, a template can be found at <code class="docutils literal notranslate"><span class="pre">doc/build/config-template.ac9</span></code>. The lines to be changed from the template are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>prefix=&quot;/shared/software/atomistic/abinit/9.4.1_gcc93_mpic341&quot;
with_mpi=&quot;${MD_MPICH}&quot;
LINALG_LIBS=&quot;-L${MD_OPENBLAS}/lib -lopenblas -lpthread &quot;
with_fft_flavor=&quot;fftw3&quot;
FFTW3_LIBS=&quot;-L${MD_FFTW} -lfftw3 -lfftw3f&quot;
with_libxc=${MD_LIBXC}
with_libxml2=&quot;${MD_GCC}&quot;
with_hdf5=&quot;${MD_HDF5}&quot;
NETCDF_FCFLAGS=&quot;-I${MD_NETCDF}/include&quot;
NETCDF_LIBS=&quot;-L${MD_NETCDF}/lib -lnetcdf&quot;
NETCDF_FORTRAN_FCFLAGS=&quot;-I${MD_NETCDF_FORTRAN}/include&quot;
NETCDF_FORTRAN_LIBS=&quot;-L${MD_NETCDF_FORTRAN}/lib -lnetcdff&quot;
LIBPSML_FCFLAGS=&quot;-I${MD_LIBPSML}/include&quot;
LIBPSML_LIBS=&quot;-L${MD_LIBPSML}/lib -lpsml&quot;
with_xmlf90=&quot;${MD_XMLF90}&quot;
</pre></div>
</div>
<p>These lines will use environment variables declared on the corresponding modules loaded above. The configure ac9 is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build_gcc93_mpic341</span><span class="o">.</span><span class="n">ac9</span>
</pre></div>
</div>
<p>To configure ABINIT is customary to create a build folder, ABINIT was build inside the folder <code class="docutils literal notranslate"><span class="pre">build_gcc93_mpic341</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build_gcc93_mpic341</span>
<span class="n">cd</span> <span class="n">build_gcc93_mpic341</span>
</pre></div>
</div>
<p>Execute the configure with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">configure</span> <span class="o">--</span><span class="k">with</span><span class="o">-</span><span class="n">config</span><span class="o">-</span><span class="n">file</span><span class="o">=../</span><span class="n">build_gcc93_mpic341</span><span class="o">.</span><span class="n">ac9</span>
</pre></div>
</div>
<p>The resulting summary of the configurations for building ABINIT are these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Core</span> <span class="n">build</span> <span class="n">parameters</span>
<span class="o">---------------------</span>

  <span class="o">*</span> <span class="n">C</span> <span class="n">compiler</span>        <span class="p">:</span> <span class="n">gnu</span> <span class="n">version</span> <span class="mf">9.3</span>
  <span class="o">*</span> <span class="n">Fortran</span> <span class="n">compiler</span>  <span class="p">:</span> <span class="n">gnu</span> <span class="n">version</span> <span class="mf">9.3</span>
  <span class="o">*</span> <span class="n">architecture</span>      <span class="p">:</span> <span class="n">intel</span> <span class="n">xeon</span> <span class="p">(</span><span class="mi">64</span> <span class="n">bits</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">debugging</span>         <span class="p">:</span> <span class="n">basic</span>
  <span class="o">*</span> <span class="n">optimizations</span>     <span class="p">:</span> <span class="n">standard</span>

  <span class="o">*</span> <span class="n">OpenMP</span> <span class="n">enabled</span>    <span class="p">:</span> <span class="n">no</span> <span class="p">(</span><span class="n">collapse</span><span class="p">:</span> <span class="n">ignored</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">MPI</span>    <span class="n">enabled</span>    <span class="p">:</span> <span class="n">yes</span> <span class="p">(</span><span class="n">flavor</span><span class="p">:</span> <span class="n">auto</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">MPI</span>    <span class="ow">in</span><span class="o">-</span><span class="n">place</span>   <span class="p">:</span> <span class="n">no</span>
  <span class="o">*</span> <span class="n">MPI</span><span class="o">-</span><span class="n">IO</span> <span class="n">enabled</span>    <span class="p">:</span> <span class="n">yes</span>
  <span class="o">*</span> <span class="n">GPU</span>    <span class="n">enabled</span>    <span class="p">:</span> <span class="n">no</span> <span class="p">(</span><span class="n">flavor</span><span class="p">:</span> <span class="n">none</span><span class="p">)</span>

  <span class="o">*</span> <span class="n">LibXML2</span> <span class="n">enabled</span>   <span class="p">:</span> <span class="n">yes</span>
  <span class="o">*</span> <span class="n">LibPSML</span> <span class="n">enabled</span>   <span class="p">:</span> <span class="n">yes</span>
  <span class="o">*</span> <span class="n">XMLF90</span>  <span class="n">enabled</span>   <span class="p">:</span> <span class="n">yes</span>
  <span class="o">*</span> <span class="n">HDF5</span> <span class="n">enabled</span>      <span class="p">:</span> <span class="n">yes</span> <span class="p">(</span><span class="n">MPI</span> <span class="n">support</span><span class="p">:</span> <span class="n">no</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">NetCDF</span> <span class="n">enabled</span>    <span class="p">:</span> <span class="n">yes</span> <span class="p">(</span><span class="n">MPI</span> <span class="n">support</span><span class="p">:</span> <span class="n">no</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">NetCDF</span><span class="o">-</span><span class="n">F</span> <span class="n">enabled</span>  <span class="p">:</span> <span class="n">yes</span> <span class="p">(</span><span class="n">MPI</span> <span class="n">support</span><span class="p">:</span> <span class="n">no</span><span class="p">)</span>

  <span class="o">*</span> <span class="n">FFT</span> <span class="n">flavor</span>        <span class="p">:</span> <span class="n">fftw3</span> <span class="p">(</span><span class="n">libs</span><span class="p">:</span> <span class="n">user</span><span class="o">-</span><span class="n">defined</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">LINALG</span> <span class="n">flavor</span>     <span class="p">:</span> <span class="n">netlib</span> <span class="p">(</span><span class="n">libs</span><span class="p">:</span> <span class="n">auto</span><span class="o">-</span><span class="n">detected</span><span class="p">)</span>
  <span class="o">*</span> <span class="n">SCALAPACK</span> <span class="n">enabled</span> <span class="p">:</span> <span class="n">no</span>
  <span class="o">*</span> <span class="n">ELPA</span> <span class="n">enabled</span>      <span class="p">:</span> <span class="n">no</span>

  <span class="o">*</span> <span class="n">FCFLAGS</span>           <span class="p">:</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span><span class="n">ffree</span><span class="o">-</span><span class="n">line</span><span class="o">-</span><span class="n">length</span><span class="o">-</span><span class="n">none</span>    <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="mf">4.7</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">fortran</span><span class="o">/</span><span class="mf">4.5</span><span class="o">.</span><span class="mi">3</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span>  <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">xmlf90</span><span class="o">/</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">4</span><span class="n">_</span>
<span class="n">gcc93</span><span class="o">/</span><span class="n">include</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">libpsml</span><span class="o">/</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">7</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span>
  <span class="o">*</span> <span class="n">CPATH</span>             <span class="p">:</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">fftw</span><span class="o">/</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">9</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">fortran</span><span class="o">/</span><span class="mf">4.5</span><span class="o">.</span><span class="mi">3</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="mf">4.7</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">hdf</span>
<span class="mi">5</span><span class="o">/</span><span class="mf">1.12</span><span class="o">.</span><span class="mi">0</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">libpsml</span><span class="o">/</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">7</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">xmlf90</span><span class="o">/</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">libxc</span><span class="o">/</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">openblas</span><span class="o">/</span><span class="mf">0.3</span>
<span class="o">.</span><span class="mi">10</span><span class="n">_gcc9</span><span class="o">.</span><span class="mf">3.0</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">parallel</span><span class="o">/</span><span class="n">mpich</span><span class="o">/</span><span class="mf">3.4</span><span class="o">.</span><span class="mi">1</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span><span class="o">/</span><span class="n">include</span><span class="p">:</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">lang</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="mf">9.3</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">include</span>

  <span class="o">*</span> <span class="n">Build</span> <span class="n">workflow</span>    <span class="p">:</span> <span class="n">monolith</span>

<span class="mi">0</span> <span class="n">deprecated</span> <span class="n">options</span> <span class="n">have</span> <span class="n">been</span> <span class="n">used</span><span class="p">:</span><span class="o">.</span>

<span class="n">Configuration</span> <span class="n">complete</span><span class="o">.</span>
<span class="n">You</span> <span class="n">may</span> <span class="n">now</span> <span class="nb">type</span> <span class="s2">&quot;make&quot;</span> <span class="n">to</span> <span class="n">build</span> <span class="n">Abinit</span><span class="o">.</span>
<span class="p">(</span><span class="ow">or</span> <span class="s2">&quot;make -j&lt;n&gt;&quot;</span><span class="p">,</span> <span class="n">where</span> <span class="o">&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">available</span> <span class="n">processors</span><span class="p">)</span>
</pre></div>
</div>
<p>ABINIT can now be build with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="o">-</span><span class="n">j12</span>
</pre></div>
</div>
<p>Running the testsuite produces these results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Suite</span>            <span class="n">failed</span>  <span class="n">passed</span>  <span class="n">succeeded</span>  <span class="n">skipped</span>  <span class="n">disabled</span>  <span class="n">run_etime</span>  <span class="n">tot_etime</span>
<span class="n">atompaw</span>               <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">2</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">bigdft</span>                <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>       <span class="mi">19</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.01</span>
<span class="n">bigdft_paral</span>          <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">4</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">built</span><span class="o">-</span><span class="ow">in</span>              <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">5</span>        <span class="mi">2</span>         <span class="mi">0</span>      <span class="mf">18.92</span>      <span class="mf">18.93</span>
<span class="n">etsf_io</span>               <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">8</span>        <span class="mi">0</span>         <span class="mi">0</span>      <span class="mf">71.88</span>      <span class="mf">72.11</span>
<span class="n">fast</span>                  <span class="mi">0</span>       <span class="mi">1</span>         <span class="mi">10</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">114.94</span>     <span class="mf">115.72</span>
<span class="n">gpu</span>                   <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">7</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">libxc</span>                 <span class="mi">1</span>       <span class="mi">7</span>         <span class="mi">27</span>        <span class="mi">0</span>         <span class="mi">0</span>    <span class="mf">1217.96</span>    <span class="mf">1220.14</span>
<span class="n">mpiio</span>                 <span class="mi">1</span>       <span class="mi">0</span>         <span class="mi">12</span>        <span class="mi">4</span>         <span class="mi">0</span>    <span class="mf">2298.48</span>    <span class="mf">2306.73</span>
<span class="n">paral</span>                 <span class="mi">1</span>      <span class="mi">11</span>         <span class="mi">33</span>       <span class="mi">76</span>         <span class="mi">0</span>    <span class="mf">6497.65</span>    <span class="mf">6502.18</span>
<span class="n">psml</span>                  <span class="mi">0</span>       <span class="mi">2</span>         <span class="mi">12</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">536.08</span>     <span class="mf">536.88</span>
<span class="n">seq</span>                   <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>       <span class="mi">18</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.01</span>
<span class="n">tutomultibinit</span>        <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">6</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">248.18</span>     <span class="mf">250.11</span>
<span class="n">tutoparal</span>             <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">1</span>       <span class="mi">26</span>         <span class="mi">0</span>     <span class="mf">154.05</span>     <span class="mf">154.50</span>
<span class="n">tutoplugs</span>             <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">4</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">tutorespfn</span>            <span class="mi">1</span>       <span class="mi">8</span>         <span class="mi">20</span>        <span class="mi">2</span>         <span class="mi">0</span>    <span class="mf">4046.58</span>    <span class="mf">4050.13</span>
<span class="n">tutorial</span>              <span class="mi">2</span>      <span class="mi">10</span>         <span class="mi">47</span>        <span class="mi">0</span>         <span class="mi">0</span>    <span class="mf">1655.70</span>    <span class="mf">1659.39</span>
<span class="n">unitary</span>               <span class="mi">0</span>       <span class="mi">1</span>         <span class="mi">17</span>       <span class="mi">20</span>         <span class="mi">0</span>     <span class="mf">107.07</span>     <span class="mf">107.41</span>
<span class="n">v1</span>                    <span class="mi">0</span>       <span class="mi">1</span>         <span class="mi">73</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">529.11</span>     <span class="mf">532.30</span>
<span class="n">v2</span>                    <span class="mi">0</span>      <span class="mi">10</span>         <span class="mi">69</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">601.61</span>     <span class="mf">606.15</span>
<span class="n">v3</span>                    <span class="mi">0</span>      <span class="mi">14</span>         <span class="mi">64</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">597.51</span>     <span class="mf">602.62</span>
<span class="n">v4</span>                    <span class="mi">0</span>      <span class="mi">12</span>         <span class="mi">49</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">559.48</span>     <span class="mf">563.87</span>
<span class="n">v5</span>                    <span class="mi">2</span>      <span class="mi">12</span>         <span class="mi">59</span>        <span class="mi">0</span>         <span class="mi">0</span>    <span class="mf">2705.48</span>    <span class="mf">2712.52</span>
<span class="n">v6</span>                    <span class="mi">0</span>       <span class="mi">7</span>         <span class="mi">54</span>        <span class="mi">0</span>         <span class="mi">0</span>    <span class="mf">1491.29</span>    <span class="mf">1495.96</span>
<span class="n">v67mbpt</span>               <span class="mi">1</span>       <span class="mi">9</span>         <span class="mi">15</span>        <span class="mi">0</span>         <span class="mi">0</span>     <span class="mf">645.63</span>     <span class="mf">648.78</span>
<span class="n">v7</span>                    <span class="mi">1</span>      <span class="mi">14</span>         <span class="mi">50</span>        <span class="mi">0</span>         <span class="mi">0</span>    <span class="mf">2800.01</span>    <span class="mf">2806.79</span>
<span class="n">v8</span>                    <span class="mi">0</span>      <span class="mi">17</span>         <span class="mi">52</span>        <span class="mi">2</span>         <span class="mi">0</span>    <span class="mf">3690.55</span>    <span class="mf">3696.26</span>
<span class="n">v9</span>                    <span class="mi">0</span>       <span class="mi">9</span>         <span class="mi">42</span>        <span class="mi">0</span>         <span class="mi">0</span>    <span class="mf">1196.94</span>    <span class="mf">1200.38</span>
<span class="n">vdwxc</span>                 <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">1</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>
<span class="n">wannier90</span>             <span class="mi">0</span>       <span class="mi">0</span>          <span class="mi">0</span>        <span class="mi">8</span>         <span class="mi">0</span>       <span class="mf">0.00</span>       <span class="mf">0.00</span>

<span class="n">Completed</span> <span class="ow">in</span> <span class="mf">3760.01</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span> <span class="n">Average</span> <span class="n">time</span> <span class="k">for</span> <span class="n">test</span><span class="o">=</span><span class="mf">36.12</span> <span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">stdev</span><span class="o">=</span><span class="mf">97.31</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
<span class="n">Summary</span><span class="p">:</span> <span class="n">failed</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">succeeded</span><span class="o">=</span><span class="mi">725</span><span class="p">,</span> <span class="n">passed</span><span class="o">=</span><span class="mi">145</span><span class="p">,</span> <span class="n">skipped</span><span class="o">=</span><span class="mi">195</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="cuda-version-with-gcc-9-3-mpich-3-4-1-and-cuda-11-1">
<h3>CUDA Version with GCC 9.3, MPICH 3.4.1 and CUDA 11.1<a class="headerlink" href="#cuda-version-with-gcc-9-3-mpich-3-4-1-and-cuda-11-1" title="Permalink to this headline">¶</a></h3>
<p>Similar to the parallel version above with the addition of this module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parallel</span><span class="o">/</span><span class="n">cuda</span><span class="o">/</span><span class="mf">11.1</span>
</pre></div>
</div>
<p>The configue file was:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>prefix=&quot;/shared/software/atomistic/abinit/9.4.1_gcc93_mpic341_gpu&quot;
with_mpi=&quot;${MD_MPICH}&quot;
with_gpu=&quot;/usr/local/cuda&quot;
with_gpu_flavor=&quot;cuda-double&quot;
GPU_CPPFLAGS=&quot;-I/usr/local/cuda/include&quot;
GPU_CFLAGS=&quot;-I/usr/local/cuda/include&quot;
GPU_CXXFLAGS=&quot;-std=c++&quot;
GPU_FCFLAGS=&quot;-I/usr/local/cuda/include&quot;
GPU_LDFLAGS=&quot;-L/usr/local/cuda/lib64 -lcublas -lcufft -lcudart -lstdc++&quot;
GPU_LIBS=&quot;-L/usr/local/cuda/lib64 -lcublas -lcufft -lcudart -lstdc++&quot;
LINALG_LIBS=&quot;-L${MD_OPENBLAS}/lib -lopenblas -lpthread &quot;
with_fft_flavor=&quot;fftw3&quot;
FFTW3_LIBS=&quot;-L${MD_FFTW} -lfftw3 -lfftw3f&quot;
with_libxc=${MD_LIBXC}
with_libxml2=&quot;${MD_GCC}&quot;
with_hdf5=&quot;${MD_HDF5}&quot;
NETCDF_FCFLAGS=&quot;-I${MD_NETCDF}/include&quot;
NETCDF_LIBS=&quot;-L${MD_NETCDF}/lib -lnetcdf&quot;
NETCDF_FORTRAN_FCFLAGS=&quot;-I${MD_NETCDF_FORTRAN}/include&quot;
NETCDF_FORTRAN_LIBS=&quot;-L${MD_NETCDF_FORTRAN}/lib -lnetcdff&quot;
LIBPSML_FCFLAGS=&quot;-I${MD_LIBPSML}/include&quot;
LIBPSML_LIBS=&quot;-L${MD_LIBPSML}/lib -lpsml&quot;
with_xmlf90=&quot;${MD_XMLF90}&quot;
</pre></div>
</div>
<p>The code must be compiled from a compute node with GPUs as the CUDA toolkit is only present there.</p>
</div>
</div>
<div class="section" id="octopus">
<h2>Octopus<a class="headerlink" href="#octopus" title="Permalink to this headline">¶</a></h2>
<div class="section" id="octopus-11-0-on-spruce-using-intel-2019">
<h3>Octopus 11.0 on Spruce using Intel 2019<a class="headerlink" href="#octopus-11-0-on-spruce-using-intel-2019" title="Permalink to this headline">¶</a></h3>
<p>This is the canonical configuration for Spruce module <code class="docutils literal notranslate"><span class="pre">dft_intel19</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">dft_intel19</span>
</pre></div>
</div>
<p>The list of modules loaded are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; module list
Currently Loaded Modulefiles:
  1) lang/gcc/9.3.0                    6) libs/fftw/3.3.8_intel19          11) atomistic/elk/7.2.42_intel19
  2) lang/intel/2019                   7) atomistic/abinit/9.4.2_intel19   12) atomistic/siesta/4.0.2_intel19
  3) lang/python/cpython_3.9.6_gcc93   8) atomistic/vasp/6.2.1_intel19     13) dft_intel19
  4) libs/libxc/5.1.5_intel19          9) atomistic/octopus/11.0_intel19
  5) libs/hdf5/1.12.1_intel19         10) atomistic/espresso/6.8_intel19
</pre></div>
</div>
<p>The building folder is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">octopus</span><span class="o">-</span><span class="mf">11.0</span><span class="o">/</span><span class="n">build_intel19</span>
</pre></div>
</div>
<p>Execute this configure line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CC</span><span class="o">=</span><span class="n">mpiicc</span> <span class="n">CXX</span><span class="o">=</span><span class="n">mpiicpc</span> <span class="n">FC</span><span class="o">=</span><span class="n">mpiifort</span> <span class="o">../</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">atomistic</span><span class="o">/</span><span class="n">octopus</span><span class="o">/</span><span class="mf">11.0</span><span class="n">_intel19</span> <span class="o">--</span><span class="k">with</span><span class="o">-</span><span class="n">lapack</span><span class="o">=</span><span class="s2">&quot;-L$</span><span class="si">{MKLROOT}</span><span class="s2">/lib/intel64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -liomp5 -lpthread -lm -ldl&quot;</span> <span class="o">--</span><span class="k">with</span><span class="o">-</span><span class="n">blas</span><span class="o">=</span><span class="s2">&quot;-L$</span><span class="si">{MKLROOT}</span><span class="s2">/lib/intel64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -liomp5 -lpthread -lm -ldl&quot;</span> <span class="o">--</span><span class="k">with</span><span class="o">-</span><span class="n">blacs</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{MKLROOT}</span><span class="s2">/lib/intel64/libmkl_blacs_intelmpi_lp64.a&quot;</span> <span class="o">--</span><span class="k">with</span><span class="o">-</span><span class="n">scalapack</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{MKLROOT}</span><span class="s2">/lib/intel64/libmkl_scalapack_lp64.a</span>
</pre></div>
</div>
<p>Build the software and install:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; make
$&gt; make install
</pre></div>
</div>
<p>Running the tests with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; make check
</pre></div>
</div>
<p>The results were:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Status</span><span class="p">:</span> <span class="mi">8</span> <span class="n">failures</span>
    <span class="n">Passed</span><span class="p">:</span>  <span class="mi">217</span> <span class="o">/</span> <span class="mi">223</span>
    <span class="n">Skipped</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">223</span>
    <span class="n">Failed</span><span class="p">:</span>  <span class="mi">5</span> <span class="o">/</span> <span class="mi">223</span>

    <span class="n">testfile</span>                                                    <span class="c1"># failed testcases</span>
    <span class="o">------------------------------------------------------------------------------</span>
    <span class="n">maxwell</span><span class="o">/</span><span class="mi">02</span><span class="o">-</span><span class="n">external</span><span class="o">-</span><span class="n">current</span><span class="o">.</span><span class="n">test</span>                            <span class="mi">3</span>
    <span class="n">periodic_systems</span><span class="o">/</span><span class="mi">06</span><span class="o">-</span><span class="n">h2o_pol_lr</span><span class="o">.</span><span class="n">test</span>                         <span class="mi">2</span>
    <span class="n">linear_response</span><span class="o">/</span><span class="mi">01</span><span class="o">-</span><span class="n">casida</span><span class="o">.</span><span class="n">test</span>                              <span class="mi">16</span>
    <span class="n">pseudopotentials</span><span class="o">/</span><span class="mi">14</span><span class="o">-</span><span class="n">carbon_dojo_psp8</span><span class="o">.</span><span class="n">test</span>                   <span class="mi">1</span>
    <span class="n">functionals</span><span class="o">/</span><span class="mi">18</span><span class="o">-</span><span class="n">mgga</span><span class="o">.</span><span class="n">test</span>                                    <span class="mi">8</span>


<span class="n">Total</span> <span class="n">run</span><span class="o">-</span><span class="n">time</span> <span class="n">of</span> <span class="n">the</span> <span class="n">testsuite</span><span class="p">:</span> <span class="mi">02</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">08</span>

<span class="n">make</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="o">***</span> <span class="p">[</span><span class="n">Makefile</span><span class="p">:</span><span class="mi">876</span><span class="p">:</span> <span class="n">check</span><span class="o">-</span><span class="n">base</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">5</span>
<span class="n">make</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Leaving</span> <span class="n">directory</span> <span class="s1">&#39;/gpfs/shared/src/octopus-11.0/build_intel19/testsuite&#39;</span>
<span class="n">make</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="o">***</span> <span class="p">[</span><span class="n">Makefile</span><span class="p">:</span><span class="mi">865</span><span class="p">:</span> <span class="n">check</span><span class="o">-</span><span class="n">wrapper</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">Leaving</span> <span class="n">directory</span> <span class="s1">&#39;/gpfs/shared/src/octopus-11.0/build_intel19/testsuite&#39;</span>
<span class="n">make</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="o">***</span> <span class="p">[</span><span class="n">Makefile</span><span class="p">:</span><span class="mi">853</span><span class="p">:</span> <span class="n">check</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">2</span>
<span class="n">make</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">Leaving</span> <span class="n">directory</span> <span class="s1">&#39;/gpfs/shared/src/octopus-11.0/build_intel19/testsuite&#39;</span>
<span class="n">make</span><span class="p">:</span> <span class="o">***</span> <span class="p">[</span><span class="n">Makefile</span><span class="p">:</span><span class="mi">545</span><span class="p">:</span> <span class="n">check</span><span class="o">-</span><span class="n">recursive</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="octopus-10-4-with-gcc-9-3">
<h3>Octopus 10.4 with GCC 9.3<a class="headerlink" href="#octopus-10-4-with-gcc-9-3" title="Permalink to this headline">¶</a></h3>
<p>Octopus is a Real Space DFT code. This instructions show how to compile Octopus 10.4 (latest version by 2021.04.19). This is the parallel version compiled with GCC 9.3</p>
<p>The modules loaded for compilation were:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="mf">9.3</span><span class="o">.</span><span class="mi">0</span> <span class="n">libs</span><span class="o">/</span><span class="n">libxc</span><span class="o">/</span><span class="mf">4.3</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span>  \
<span class="n">libs</span><span class="o">/</span><span class="n">hdf5</span><span class="o">/</span><span class="mf">1.12</span><span class="o">.</span><span class="mi">0</span><span class="n">_gcc93</span> \
<span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">/</span><span class="mf">4.7</span><span class="o">.</span><span class="mi">4</span><span class="n">_gcc93</span> \
<span class="n">libs</span><span class="o">/</span><span class="n">netcdf</span><span class="o">/</span><span class="n">fortran</span><span class="o">-</span><span class="mf">4.5</span><span class="o">.</span><span class="mi">3</span><span class="n">_gcc93</span> \
<span class="n">libs</span><span class="o">/</span><span class="n">openblas</span><span class="o">/</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">10</span><span class="n">_gcc93</span> \
<span class="n">libs</span><span class="o">/</span><span class="n">fftw</span><span class="o">/</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">9</span><span class="n">_gcc93</span> \
<span class="n">parallel</span><span class="o">/</span><span class="n">mpich</span><span class="o">/</span><span class="mf">3.4</span><span class="o">.</span><span class="mi">1</span><span class="n">_gcc93</span>
</pre></div>
</div>
<p>The sources can be downloaded from the developers and uncompressed with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">octopus</span><span class="o">-</span><span class="n">code</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="mf">10.4</span><span class="o">/</span><span class="n">octopus</span><span class="o">-</span><span class="mf">10.4</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">octopus</span><span class="o">-</span><span class="mf">10.4</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>It is customary to compile codes on a separate folder from the sources.
The foler <code class="docutils literal notranslate"><span class="pre">build_gcc93</span></code> is created inside the sources for that purpose:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">octopus</span><span class="o">-</span><span class="mf">10.4</span>
<span class="n">mkdir</span> <span class="n">build_gcc93_mpic341</span>
<span class="n">cd</span> <span class="n">build_gcc93_mpich341</span>
</pre></div>
</div>
<p>The configure line was:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>../configure --prefix=/shared/software/atomistic/octopus/10.4_gcc93_mpic341  \
--with-libxc-prefix=${MD_LIBXC} --with-blas=&quot; -L${MD_OPENBLAS} -lopenblas&quot; \
--with-fftw-prefix=${MD_FFTW} --with-netcdf-prefix=${MD_NETCDF_FORTRAN} \
--with-mpi=${MD_MPICH} --enable-mpi
</pre></div>
</div>
<p>On Thorny Flat the results from the testsuite were:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">************************</span>
<span class="n">Passed</span><span class="p">:</span>  <span class="mi">184</span> <span class="o">/</span> <span class="mi">200</span>
<span class="n">Skipped</span><span class="p">:</span> <span class="mi">16</span> <span class="o">/</span> <span class="mi">200</span>

<span class="n">Everything</span> <span class="n">seems</span> <span class="n">to</span> <span class="n">be</span> <span class="n">OK</span>

<span class="n">Total</span> <span class="n">run</span><span class="o">-</span><span class="n">time</span> <span class="n">of</span> <span class="n">the</span> <span class="n">testsuite</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">42</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="quantum-espresso">
<h2>Quantum Espresso<a class="headerlink" href="#quantum-espresso" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quantum-espresso-6-8-on-spruce-using-intel-2019">
<h3>Quantum Espresso 6.8 on Spruce using Intel 2019<a class="headerlink" href="#quantum-espresso-6-8-on-spruce-using-intel-2019" title="Permalink to this headline">¶</a></h3>
<p>Download the sources:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">QEF</span><span class="o">/</span><span class="n">q</span><span class="o">-</span><span class="n">e</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">qe</span><span class="o">-</span><span class="mf">6.8</span><span class="o">/</span><span class="n">qe</span><span class="o">-</span><span class="mf">6.8</span><span class="o">-</span><span class="n">ReleasePack</span><span class="o">.</span><span class="n">tgz</span>
</pre></div>
</div>
<p>This is the canonical configuration for Spruce module <code class="docutils literal notranslate"><span class="pre">dft_intel19</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">dft_intel19</span>
</pre></div>
</div>
<p>The list of modules loaded are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; module list
Currently Loaded Modulefiles:
  1) lang/gcc/9.3.0                       10) libs/gridxc/0.9.6_intel19
  2) lang/intel/2019                      11) atomistic/abinit/9.4.2_intel19
  3) lang/python/cpython_3.9.7_gcc93      12) atomistic/vasp/6.2.1_intel19
  4) libs/libxc/5.1.5_intel19             13) atomistic/octopus/11.0_intel19
  5) libs/hdf5/1.12.1_intel19             14) atomistic/espresso/6.8_intel19
  6) libs/fftw/3.3.8_intel19              15) atomistic/elk/7.2.42_intel19
  7) libs/arpack-ng/3.8.0_intel19         16) atomistic/siesta/4.1.5_intel19
  8) libs/xmlf90/1.5.4_intel19            17) atomistic/siesta/4.1.5_psml_intel19
  9) libs/psml/1.1.10_intel19             18) dft_intel19
</pre></div>
</div>
<p>Uncompress the sources:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; tar -zxvf qe-6.8-ReleasePack.tgz
$&gt; cd qe-6.8
</pre></div>
</div>
<p>Configure the sources to use HDF5, libXC and FFTW 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; ./configure CC=mpiicc CXX=mpiicpc FC=mpiifort --with-hdf5 --with-libxc --enable-parallel --prefix=/shared/software/atomistic/qe/6.8_intel19 LDFLAGS=&quot;-L${MD_FFTW}/lib -lfftw3&quot;
</pre></div>
</div>
<p>Build the binaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; make
$&gt; make install
$&gt; make check
</pre></div>
</div>
</div>
</div>
<div class="section" id="siesta">
<h2>Siesta<a class="headerlink" href="#siesta" title="Permalink to this headline">¶</a></h2>
<p>Siesta is a electronic structure code using linear scaling algorithms.
The version compiled was 4.0.2. The code was compiled with Intel Compilers 2018
and 2019</p>
<p>To compile the code a arch.make needs to be created. The contents of the file
are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SIESTA_ARCH=intel-mpi

FC=mpiifort
FFLAGS=-g -xHost -O3 -prec-div -prec-sqrt -fp-model precise -qopt-prefetch -fPIC -m64

DUMMY_FOX=--enable-dummy
FFLAGS_DEBUG=-g -O2 -debug full -traceback -C
LDFLAGS= -static-intel -static-libgcc
RANLIB=ranlib
FC_SERIAL=ifort
FPPFLAGS_CDF=

MPI_INTERFACE=libmpi_f90.a
MKL_INCLUDE=-I$(MKLROOT)/include
MPI_LIBS=-L$(I_MPI_ROOT)/intel64/lib -lmpi
MKL_LIBS=$(MKLROOT)/lib/intel64
MPI_INCLUDE=-I$(I_MPI_ROOT)/intel64/include
INCFLAGS=$(MPI_INCLUDE) $(MKL_INCLUDE)

FPPFLAGS_MPI=-DMPI -DMPI_TIMING -DFC_HAVE_FLUSH -DFC_HAVE_ABORT -DSIESTA__NO_MRRR

NETCDF_LIBS=
NETCDF_INTERFACE=

LIBS=-mkl=cluster $(MPI_LIBS) -qopenmp -lpthread -lstdc++ -ldl

SYS=nag
FPPFLAGS= $(FPPFLAGS_CDF) $(FPPFLAGS_MPI)


atom.o: atom.F
        $(FC) -c $(FFLAGS_DEBUG) $(INCFLAGS) $(FPPFLAGS) $(FPPFLAGS_fixed_F) $&lt;
state_analysis.o: state_analysis.F
        $(FC) -c $(FFLAGS_DEBUG) $(INCFLAGS) $(FPPFLAGS) $(FPPFLAGS_fixed_F) $&lt;

.F.o:
        $(FC) -c $(FFLAGS) $(INCFLAGS) $(FPPFLAGS) $&lt;
.f.o:
        $(FC) -c $(FFLAGS) $(INCFLAGS) $&lt;
.F90.o:
        $(FC) -c $(FFLAGS) $(INCFLAGS) $(FPPFLAGS) $&lt;
.f90.o:
        $(FC) -c $(FFLAGS) $(INCFLAGS) $&lt;
</pre></div>
</div>
</div>
<div class="section" id="castep">
<h2>CASTEP<a class="headerlink" href="#castep" title="Permalink to this headline">¶</a></h2>
<p>CASTEP is a leading code for calculating the properties of materials from first principles. Using density functional theory, it can simulate a wide range of properties of materials proprieties including energetics, structure at the atomic level, vibrational properties, electronic response properties etc. In particular it has a wide range of spectroscopic features that link directly to experiment, such as infra-red and Raman spectroscopies, NMR, and core level spectra.</p>
<p>CASTEP can only be compiled with Intel 2018 due to a bug on Intel 2019 MPI implementation. The code was compiled on both clusters with Intel 2018.</p>
<p>Modules used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">purge</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">intelpython_2</span><span class="o">.</span><span class="mf">7.16</span> <span class="n">lang</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mi">2018</span>
</pre></div>
</div>
<p>Compilation line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>make ARCH=linux_x86_64_ifort18 COMMS_ARCH=mpi SUBARCH=mpi FFT=mkl MATHLIBS=mkl10 INSTALL_DIR=/shared/software/atomistic/castep/19.11-mpi_intel18 \
FFTLIBDIR=${MKLROOT} MATHLIBDIR=${MKLROOT} -j 8
</pre></div>
</div>
<p>A run of a test suite o both clusters passes all tests.</p>
<p>On Spruce:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ make ARCH=linux_x86_64_ifort18 COMMS_ARCH=mpi SUBARCH=mpi FFT=mkl MATHLIBS=mkl10 INSTALL_DIR=/shared/software/atomistic/castep/19.11-mpi_intel18 \
FFTLIBDIR=${MKLROOT} MATHLIBDIR=${MKLROOT} -j 8 check

Makefile:595: GNU make version 3.82 or later is recommended: proceeding with Make 3.81
Some modules may be compiled at unnecessarily low optimisation level

make -C &quot;Test&quot; ARCH=linux_x86_64_ifort18--mpi check-simple
make[1]: Entering directory `/gpfs/shared/src/CASTEP-19.11/Test&#39;
rm -f */*/*.{castep,dfpt_wvfn,fd_wvfn,wvfn.*,*.err}
../bin/testcode.py -q  --processors=4 --total-processors=16  -e /gpfs/shared/src/CASTEP-19.11/obj/linux_x86_64_ifort18--mpi/castep.mpi -c simple
................................................................................................................................................
................................................................................................................................................
................................................................................................................................................
................................ [464/464]
make[1]: Leaving directory `/gpfs/shared/src/CASTEP-19.11/Test&#39;
</pre></div>
</div>
<p>On Thorny:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ make ARCH=linux_x86_64_ifort18 COMMS_ARCH=mpi SUBARCH=mpi FFT=mkl MATHLIBS=mkl10 INSTALL_DIR=/shared/software/atomistic/castep/19.11-mpi_intel18 \
FFTLIBDIR=${MKLROOT} MATHLIBDIR=${MKLROOT} -j 8 check
 make -C &quot;Test&quot; ARCH=linux_x86_64_ifort18--mpi check-simple
 make[1]: Entering directory `/gpfs20/shared/src/CASTEP-19.11/Test&#39;
 rm -f */*/*.{castep,dfpt_wvfn,fd_wvfn,wvfn.*,*.err}
 ../bin/testcode.py -q  --processors=4 --total-processors=48  -e /gpfs20/shared/src/CASTEP-19.11/obj/linux_x86_64_ifort18--mpi/castep.mpi -c simple
 ..................................................................................................................................................
 ..................................................................................................................................................
 ..................................................................................................................................................
 .......................... [464/464]
 make[1]: Leaving directory `/gpfs20/shared/src/CASTEP-19.11/Test&#39;
</pre></div>
</div>
</div>
<div class="section" id="vasp">
<h2>VASP<a class="headerlink" href="#vasp" title="Permalink to this headline">¶</a></h2>
<p>The Vienna Ab initio Simulation Package (VASP) is a computer program for atomic scale materials modelling, e.g. electronic structure calculations and quantum-mechanical molecular dynamics, from first principles.</p>
<p>VASP 6.2.1 was compiled with Intel 2019 on both Thorny and Spruce.
There are two builds of VASP, one compiled with a MKL running the rutines sequential mode (no multithreading) and another build with OpenMP enabled and MKL running in multithreaded mode.</p>
<p>VASP is a proprietary code that require a license to legally run the code.
The downloaded file is called <code class="docutils literal notranslate"><span class="pre">vasp.6.2.1.tar.gz</span></code> that uncompress into a folder <code class="docutils literal notranslate"><span class="pre">vasp.6.2.1</span></code>.</p>
<p>Before compiling VASP, you need to edit the file <cite>makefile.include</cite> for the sequential version. The files for Spruce include multidispaching code for the various CPUs on that cluster:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Precompiler options
CPP_OPTIONS= -DHOST=\&quot;LinuxIFC\&quot;\
           -DMPI -DMPI_BLOCK=8000 \
           -Duse_collective \
           -DCACHE_SIZE=4000 \
           -DscaLAPACK \
           -Dvasp6 \
           -Duse_bse_te \
           -Dtbdyn \
           -Dfock_dblbuf

CPP        = fpp -f_com=no -free -w0  $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS)

FC         = mpiifort
FCL        = mpiifort

FREE       = -free -names lowercase

FFLAGS     = -assume byterecl -w -axSANDYBRIDGE,IVYBRIDGE,HASWELL -static-libgcc -traceback -g
OFLAG      = -O2
OFLAG_IN   = $(OFLAG)
DEBUG      = -O0

MKL_PATH   = $(MKLROOT)/lib/intel64
BLAS       = ${MKLROOT}/lib/intel64/libmkl_core.a
LAPACK     = ${MKLROOT}/lib/intel64/libmkl_intel_lp64.a ${MKLROOT}/lib/intel64/libmkl_sequential.a
BLACS      = ${MKLROOT}/lib/intel64/libmkl_blacs_intelmpi_lp64.a
SCALAPACK  = ${MKLROOT}/lib/intel64/libmkl_scalapack_lp64.a

OBJECTS    = fftmpiw.o fftmpi_map.o fft3dlib.o fftw3d.o

INCS       = -I${MKLROOT}/include -I$(MKLROOT)/include/fftw

LLIBS      =  $(SCALAPACK) -Wl,--start-group $(LAPACK) $(BLAS) $(BLACS) -Wl,--end-group -lpthread -lm -ldl

OBJECTS_O1 += fftw3d.o fftmpi.o fftmpiw.o
OBJECTS_O2 += fft3dlib.o

# For what used to be vasp.5.lib
CPP_LIB    = $(CPP)
FC_LIB     = $(FC)
CC_LIB     = icc
CFLAGS_LIB = -O -static-libgcc -axSANDYBRIDGE,IVYBRIDGE,HASWELL
FFLAGS_LIB = -O2 -static-libgcc -axSANDYBRIDGE,IVYBRIDGE,HASWELL
FREE_LIB   = $(FREE)

OBJECTS_LIB= linpack_double.o getshmem.o

# For the parser library
CXX_PARS   = icpc
LLIBS      += -lstdc++ -static-libstdc++ -static-libgcc -static-intel

# Normally no need to change this
SRCDIR     = ../../src
BINDIR     = ../../bin
</pre></div>
</div>
<p>The version that runs MKL with multithreading and enables OpenMP is like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Precompiler options
CPP_OPTIONS= -DHOST=\&quot;LinuxIFC\&quot;\
           -DMPI -DMPI_BLOCK=8000 \
           -Duse_collective \
           -DCACHE_SIZE=4000 \
           -DscaLAPACK \
           -Dvasp6 \
           -Duse_bse_te \
           -Dtbdyn \
           -Dfock_dblbuf \
           -D_OPENMP

CPP        = fpp -f_com=no -free -w0  $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS)

FC         = mpiifort
FCL        = mpiifort

FREE       = -free -names lowercase

FFLAGS     = -assume byterecl -w -axSANDYBRIDGE,IVYBRIDGE,HASWELL -static-intel -static-libgcc -traceback -g -qopenmp
OFLAG      = -O2
OFLAG_IN   = $(OFLAG)
DEBUG      = -O0

MKL_PATH   = $(MKLROOT)/lib/intel64
BLAS       = ${MKLROOT}/lib/intel64/libmkl_core.a
LAPACK     = ${MKLROOT}/lib/intel64/libmkl_intel_lp64.a ${MKLROOT}/lib/intel64/libmkl_intel_thread.a
BLACS      = ${MKLROOT}/lib/intel64/libmkl_blacs_intelmpi_lp64.a
SCALAPACK  = ${MKLROOT}/lib/intel64/libmkl_scalapack_lp64.a

OBJECTS    = fftmpiw.o fftmpi_map.o fft3dlib.o fftw3d.o

INCS       = -I${MKLROOT}/include -I$(MKLROOT)/include/fftw

LLIBS      = $(SCALAPACK) -Wl,--start-group $(LAPACK) $(BLAS) $(BLACS) -Wl,--end-group -liomp5 -lpthread -lm -ldl

OBJECTS_O1 += fftw3d.o fftmpi.o fftmpiw.o
OBJECTS_O2 += fft3dlib.o

# For what used to be vasp.5.lib
CPP_LIB    = $(CPP)
FC_LIB     = $(FC)
CC_LIB     = icc
CFLAGS_LIB = -O -axSANDYBRIDGE,IVYBRIDGE,HASWELL -static-libgcc
FFLAGS_LIB = -O2 -axSANDYBRIDGE,IVYBRIDGE,HASWELL -static-libgcc
FREE_LIB   = $(FREE)

OBJECTS_LIB= linpack_double.o getshmem.o

# For the parser library
CXX_PARS   = icpc
LLIBS      += -lstdc++ -static-libstdc++ -static-libgcc -static-intel

# Normally no need to change this
SRCDIR     = ../../src
BINDIR     = ../../bin
</pre></div>
</div>
<p>The only module needed to compile VASP is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">purge</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="mi">2019</span>
</pre></div>
</div>
<p>VASP includes a testsuite and running it produces this final results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==================================================================</span>
<span class="n">SUMMARY</span><span class="p">:</span>
<span class="o">==================================================================</span>
<span class="n">The</span> <span class="n">following</span> <span class="n">tests</span> <span class="n">failed</span><span class="p">,</span> <span class="n">please</span> <span class="n">check</span> <span class="n">the</span> <span class="n">output</span> <span class="n">file</span> <span class="n">manually</span><span class="p">:</span>
<span class="n">bulk_SiO2_LOPTICS</span> <span class="n">bulk_SiO2_LOPTICS_nosym</span> <span class="n">bulk_SiO2_LOPTICS_RPR</span>
<span class="n">bulk_SiO2_LPEAD</span> <span class="n">bulk_SiO2_LPEAD_nosym</span> <span class="n">bulk_SiO2_LPEAD_RPR</span>
<span class="n">C_2x2x2_CORE_CON</span> <span class="n">C_2x2x2_CORE_CON_RPR</span>
</pre></div>
</div>
<div class="section" id="vasp-6-2-1-on-spruce-using-intel-2019">
<h3>VASP 6.2.1 on Spruce using Intel 2019<a class="headerlink" href="#vasp-6-2-1-on-spruce-using-intel-2019" title="Permalink to this headline">¶</a></h3>
<p>This is the canonical configuration for Spruce module <code class="docutils literal notranslate"><span class="pre">dft_intel19</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">dft_intel19</span>
</pre></div>
</div>
<p>The list of modules loaded are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; module list
Currently Loaded Modulefiles:
  1) lang/gcc/9.3.0                    6) libs/fftw/3.3.8_intel19          11) atomistic/elk/7.2.42_intel19
  2) lang/intel/2019                   7) atomistic/abinit/9.4.2_intel19   12) atomistic/siesta/4.0.2_intel19
  3) lang/python/cpython_3.9.6_gcc93   8) atomistic/vasp/6.2.1_intel19     13) dft_intel19
  4) libs/libxc/5.1.5_intel19          9) atomistic/octopus/11.0_intel19
  5) libs/hdf5/1.12.1_intel19         10) atomistic/espresso/6.8_intel19
</pre></div>
</div>
<p>In case of having a previous build, erase the folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">build</span><span class="o">/*</span>
</pre></div>
</div>
<p>Create a file <code class="docutils literal notranslate"><span class="pre">makefile.include</span></code> with the contents as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Precompiler options
CPP_OPTIONS= -DHOST=\&quot;LinuxIFC\&quot;\
             -DMPI -DMPI_BLOCK=8000 \
             -DCACHE_SIZE=4000 \
             -DscaLAPACK \
             -Dvasp6 \
             -Duse_bse_te \
             -Dtbdyn \
             -Dfock_dblbuf

CPP        = fpp -f_com=no -free -w0  $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS)

FC         = mpiifort
FCL        = mpiifort

FREE       = -free -names lowercase

FFLAGS     = -assume byterecl -w -traceback -static-libstdc++ -static-libgcc -heap-arrays 1 -axAVX,CORE-AVX2,CORE-AVX-I
OFLAG      = -O2 -g3
OFLAG_IN   = $(OFLAG)
DEBUG      = -O0 -g3

MKL_PATH   = $(MKLROOT)/lib/intel64
BLAS       = -mkl=sequential -static-intel
LAPACK     =
BLACS      = -lmkl_blacs_intelmpi_lp64
SCALAPACK  = $(MKL_PATH)/libmkl_scalapack_lp64.a $(BLACS)

OBJECTS    = fftmpiw.o fftmpi_map.o fft3dlib.o fftw3d.o

INCS       =-I$(MKLROOT)/include/fftw

LLIBS      = $(SCALAPACK) $(LAPACK) $(BLAS)

OBJECTS_O1 += fftw3d.o fftmpi.o fftmpiw.o
OBJECTS_O2 += fft3dlib.o

# For what used to be vasp.5.lib
CPP_LIB    = $(CPP)
FC_LIB     = $(FC)
CC_LIB     = icc
CFLAGS_LIB = -O -static-libgcc -axAVX,CORE-AVX2,CORE-AVX-I
FFLAGS_LIB = -O1 -static-libgcc -axAVX,CORE-AVX2,CORE-AVX-I
FREE_LIB   = $(FREE)

OBJECTS_LIB= linpack_double.o getshmem.o

# For the parser library
CXX_PARS   = icpc
LLIBS      += -lstdc++ -static-libstdc++ -axAVX,CORE-AVX2,CORE-AVX-I

# Normally no need to change this
SRCDIR     = ../../src
BINDIR     = ../../bin
</pre></div>
</div>
<p>Execute make, do not try to use multiple compilations threads as this fails.</p>
<blockquote>
<div>make</div></blockquote>
<p>Installation is manual and consists of copying the 3 binaries to the folder that will be added to the $PATH:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">av</span> <span class="nb">bin</span><span class="o">/</span> <span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">software</span><span class="o">/</span><span class="n">atomistic</span><span class="o">/</span><span class="n">vasp</span><span class="o">/</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">1</span><span class="n">_intel19</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span>
</pre></div>
</div>
<p>Testsuite can be run by going into testsuite and running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">testsuite</span>
<span class="o">./</span><span class="n">runtest</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="611.BigData.html" class="btn btn-neutral float-right" title="Big Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="609.CHARM++_NAMD.html" class="btn btn-neutral float-left" title="CHARM++ and NAMD" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, West Virginia University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>