

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>R Language &mdash; WVU-RC 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Perl Language" href="44.Perl.html" />
    <link rel="prev" title="Python Language" href="42.Python.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WVU-RC
          

          
            
            <img src="../_static/ResearchComputing.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="10.Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="20.QuickStart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="30.BasicUser.html">For Basic Users</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="40.AdvancedUser.html">For Advanced Users</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="41.Singularity.html">Singularity Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="42.Python.html">Python Language</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">R Language</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#activating-r">Activating R</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-r-from-the-terminal">Using R from the Terminal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-r-packages-in-default-directories">Installing R Packages in default Directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-r-packages-in-non-default-directories">Installing R Packages in non-default directories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-install-packages">Using install.packages()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-r-cmd-install">Using R CMD INSTALL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-installed-packages-from-non-default-directories">Using Installed Packages from non-default directories</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="44.Perl.html">Perl Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="45.Conda.html">Conda</a></li>
<li class="toctree-l2"><a class="reference internal" href="46.GPU.html">GPU Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="47.Modules.html">Environment Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="48.Jupyter.html">Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="49.Matlab.html">MATLAB</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="50.Developers.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="60.Administrators.html">For Administrators</a></li>
<li class="toctree-l1"><a class="reference internal" href="70.DomainSpecific.html">Domain Specific Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="80.ClusterSpecific.html">Clusters Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="90.References.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WVU-RC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="40.AdvancedUser.html">For Advanced Users</a> &raquo;</li>
        
      <li>R Language</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/text/43.R.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="r-language">
<span id="ad-r"></span><h1>R Language<a class="headerlink" href="#r-language" title="Permalink to this headline">¶</a></h1>
<p>R is a language and environment for statistical computing and graphics. It is a GNU project which is similar to the S language and environment which was developed at Bell Laboratories (formerly AT&amp;T, now Lucent Technologies) by John Chambers and colleagues. R can be considered as a different implementation of S. There are some important differences, but much code written for S runs unaltered under R.</p>
<p>R provides a wide variety of statistical (linear and nonlinear modelling, classical statistical tests, time-series analysis, classification, clustering, …) and graphical techniques, and is highly extensible. The S language is often the vehicle of choice for research in statistical methodology, and R provides an Open Source route to participation in that activity.</p>
<p>One of R’s strengths is the ease with which well-designed publication-quality plots can be produced, including mathematical symbols and formulae where needed. Great care has been taken over the defaults for the minor design choices in graphics, but the user retains full control.</p>
<div class="section" id="activating-r">
<h2>Activating R<a class="headerlink" href="#activating-r" title="Permalink to this headline">¶</a></h2>
<p>On Spruce Knob R is preinstalled from RHEL repositories. The RHEL version is 3.0.2 and it is considered too old for most scientific applications.
You should consider using the environment module for R which activates R 3.5.2 a far more recent version and compatible with most recent R packages.
To activate R 3.5.2 use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">R</span><span class="o">/</span><span class="mf">3.5</span><span class="o">.</span><span class="mi">2</span>
</pre></div>
</div>
<p>On Thorny Flat, R is not preinstalled and the only choice is to use the environment module, execute the command below to activate it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">lang</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="mf">8.2</span><span class="o">.</span><span class="mi">0</span> <span class="n">lang</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">jdk1</span><span class="o">.</span><span class="mf">8.0_201</span> <span class="n">libs</span><span class="o">/</span><span class="n">openblas</span><span class="o">/</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">7</span><span class="n">_gcc82</span> <span class="n">lang</span><span class="o">/</span><span class="n">r</span><span class="o">/</span><span class="mf">3.5</span><span class="o">.</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="using-r-from-the-terminal">
<h2>Using R from the Terminal<a class="headerlink" href="#using-r-from-the-terminal" title="Permalink to this headline">¶</a></h2>
<p>The R package includes two executables, <cite>R</cite> and <cite>Rscript</cite>. The command R is used to start a text-based interactive session, on the terminal execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; R

R version 3.5.2 (2018-12-20) -- &quot;Eggshell Igloo&quot;
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#39;license()&#39; or &#39;licence()&#39; for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type &#39;contributors()&#39; for more information and
&#39;citation()&#39; on how to cite R or R packages in publications.

Type &#39;demo()&#39; for some demos, &#39;help()&#39; for on-line help, or
&#39;help.start()&#39; for an HTML browser interface to help.
Type &#39;q()&#39; to quit R.

&gt;
</pre></div>
</div>
<p>From there you can start typing R commands. Another way of working in R, and more suited for HPC environments is using R scripts.
To do so, first write your script in a <code class="docutils literal notranslate"><span class="pre">.R</span></code> file, for example, lets create a file <code class="docutils literal notranslate"><span class="pre">hello.R</span></code> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env Rscript</span>
<span class="n">sayHello</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(){</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">sayHello</span><span class="p">()</span>
</pre></div>
</div>
<p>The first line indicate to the shell that this is a R script. The next step is to change permissions to the file to become executable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; chmod +x hello.R
</pre></div>
</div>
<p>The script is ready for execution. As this is such small program you can run it directly on the head node:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$&gt; ./hello.R
[1] &quot;hello&quot;
</pre></div>
</div>
<p>However, for large executions, you should always create a submission script.
Create a file “runjob.pbs” with this content (For Spruce):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash

#PBS -N MY_R_SCRIPT
#PBS -q debug
#PBS -j oe
#PBS -l nodes=1:ppn=1

cd $PBS_O_WORKDIR

module purge
module load lang/R/3.5.2

./hello.R
</pre></div>
</div>
<p>The name of the job is declared with <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-N</span> <span class="pre">MY_R_SCRIPT</span></code>. The queue is declared with <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-q</span> <span class="pre">debug</span></code>, for executions that run in less than 4 hours <code class="docutils literal notranslate"><span class="pre">standby</span></code> is the preferable choice. The line <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-j</span> <span class="pre">oe</span></code> joins the error with the output in a single file. The line <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-l</span> <span class="pre">nodes=1:ppn=1</span></code> is equivalent with the default requesting a single node and a single core for the execution. In most cases R run serially but we will discuss some parallel executions below.
The line <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">$PBS_O_WORKDIR</span></code> change directory to the place where the command <code class="docutils literal notranslate"><span class="pre">qsub</span></code> was executed.
The line <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">purge</span></code> clean the environment of any modules and <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">lang/R/3.5.2</span></code>, this is the only line that changes between running on Spruce or Thorny as the names of the modules are different. The names of modules is converging so the need of this change will be less likely in the future.</p>
<p>Finally <code class="docutils literal notranslate"><span class="pre">./hello.R</span></code> executes the script and the output will be written in a file like <code class="docutils literal notranslate"><span class="pre">MY_R_SCRIPT.o4714619</span></code> with a different JobID at the end.
The contents of the file are shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat MY_R_SCRIPT.o4714619
[1] &quot;hello&quot;
</pre></div>
</div>
</div>
<div class="section" id="installing-r-packages-in-default-directories">
<h2>Installing R Packages in default Directories<a class="headerlink" href="#installing-r-packages-in-default-directories" title="Permalink to this headline">¶</a></h2>
<p>The two usual ways to install R packages from CRAN is either executing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">install</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span><span class="s1">&#39;&lt;Package Name&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>from the R prompt. Or using the command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="n">CMD</span> <span class="n">INSTALL</span> <span class="o">&lt;</span><span class="n">package</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>from the command line. The second command only works if you have already
downloaded a copy of the package from CRAN or an external site. The
first will automatically download the package from CRAN. R will
automatically detect that you do not have permissions to write in the
system-wide R library folder and will prompt if you would like to
install in a local directory from within your home directory. This
folder will also be checked automatically when you run R for packages,
allowing you to use anything you install in this way.</p>
<p>For example, lets assume that you want to install the package “dplyr”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; install.packages(&quot;dplyr&quot;)
Installing package into ‘/gpfs/home/&lt;username&gt;/R/x86_64-pc-linux-gnu-library/3.5’
(as ‘lib’ is unspecified)
--- Please select a CRAN mirror for use in this session ---
Secure CRAN mirrors

 1: 0-Cloud [https]                   2: Algeria [https]
...
...
57: USA (CA 1) [https]               58: USA (IA) [https]
59: USA (KS) [https]                 60: USA (MI 1) [https]
61: USA (MI 2) [https]               62: USA (OR) [https]
63: USA (TN) [https]                 64: USA (TX 1) [https]
65: Uruguay [https]                  66: (other mirrors)


Selection: 63

also installing the dependencies ‘backports’, ‘ellipsis’, ‘digest’, ‘zeallot’, ‘utf8’, ‘vctrs’, ‘cli’, ‘crayon’, ‘fansi’, ‘pillar’, ‘purrr’, ‘assertthat’, ‘glue’, ‘magrittr’, ‘pkgconfig’, ‘R6’, ‘Rcpp’, ‘rlang’, ‘tibble’, ‘tidyselect’, ‘BH’, ‘plogr’
</pre></div>
</div>
<p>After some downloads and compilations the code will be installed on your local folder <code class="docutils literal notranslate"><span class="pre">$HOME/R/x86_64-pc-linux-gnu-library/3.5</span></code></p>
</div>
<div class="section" id="installing-r-packages-in-non-default-directories">
<h2>Installing R Packages in non-default directories<a class="headerlink" href="#installing-r-packages-in-non-default-directories" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-install-packages">
<h3>Using install.packages()<a class="headerlink" href="#using-install-packages" title="Permalink to this headline">¶</a></h3>
<p>To use install.packages from the R prompt, before you start R you need
to modify the R_LIBS environment variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">R_LIBS</span><span class="o">=&lt;</span><span class="nb">dir</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Then inside the R prompt you execute install.packages() as normal (see
above).</p>
</div>
<div class="section" id="using-r-cmd-install">
<h3>Using R CMD INSTALL<a class="headerlink" href="#using-r-cmd-install" title="Permalink to this headline">¶</a></h3>
<p>For ‘R CMD INSTALL’ command, you can specify the path with the l flag
(lowercase ‘L’)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="n">CMD</span> <span class="n">INSTALL</span> <span class="o">-</span><span class="n">l</span> <span class="o">&lt;</span><span class="nb">dir</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">package_name</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="using-installed-packages-from-non-default-directories">
<h3>Using Installed Packages from non-default directories<a class="headerlink" href="#using-installed-packages-from-non-default-directories" title="Permalink to this headline">¶</a></h3>
<p>To use locally installed packages, before you execute R you just need to
modify the R_LIBS environment variable to tell R where to search for
local packages.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">R_LIBS</span><span class="o">=&lt;</span><span class="nb">dir</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="44.Perl.html" class="btn btn-neutral float-right" title="Perl Language" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="42.Python.html" class="btn btn-neutral float-left" title="Python Language" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, West Virginia University

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>